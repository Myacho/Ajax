<!DOCTYPE html>
<html>
	<head>
		<meta charset="utf-8" />
		<title>Ajax进阶</title>
		<link rel="stylesheet" href="css/style.css" />
		<script type="text/javascript" src="js/jquery-3.2.1.js" ></script>
		<script type="text/javascript">
			$(function(){
				$("form input[type=button]").click(function(){
					/*
					$.ajax({
						type:"POST",
						url:"user1.php",
						data:$("form").serialize(),
						success:function(response,status,xhr){
							$("#box").html(response);
						},
						//timeout:3000,//如果请求时间过长，可以设置超时
						//global:false,//如果不想触发全局事件
						//错误处理
						error:function(xhr,errorText,errorType){
							//alert("错误！");
							//alert(errorText + ":" + errorType);
							alert(xhr.status + ":" + xhr.statusText);
						}
					});
					
					//局部错误，post可以用连缀方法提示错误，用fail代替error
					$.post("user1.php").fail(function(){
						alert("错误！");
						alert(errorText + ":" + errorType);
						alert(xhr.status + ":" + xhr.statusText);
					});
					*/
					//全局错误,绑定在document上
					$.post("user1.php");
				
				});
				$(document).ajaxError(function(event,xhr,settings,errorType){
					//alert("error!");
//					alert(event.type);
//					alert(event.target);
//					for(var i in event){
//						document.write(i + "</br>");
//					}
					//alert(settings);
//					for(var i in settings){
//						document.write(i + "</br>");
//					}
					//alert(settings.url);
					alert(settings.type);
					
				});
				
				$(document).ajaxStart(function(){
					$(".loading").show();
				}).ajaxStop(function(xhr,errorText,errorType){
					$(".loading").hide();
				});
				
				
				
			});
		</script>
	</head>
	<body>
		<!--<input type="button" value="异步加载数据" />-->
		<form>
			用户名：<input type="text" name="user" />
			邮箱：<input type="text" name="email" />
			<input type="radio" name="sex" value="男" />男
			<input type="radio" name="sex" value="女" />女
			<input type="button" value="提交" />
		</form>
		<span class="loading">正在加载中...</span>
		<div id="box"></div>
	</body>
</html>
